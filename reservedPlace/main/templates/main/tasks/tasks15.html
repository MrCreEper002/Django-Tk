{% extends 'main/loaut.html' %}
{% block title %}Задания {% endblock title %}
{% block content %}
<main role="main" class="col-md-8 ml-sm-auto col-lg-11 pt-3 px-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
        <h1 class="h2">{{title}}</h1>
      </div>
    <h1 class="h5">php уровень: {{level}}</h1><p>{{body}}</p>
    <p class="mt-3 font-weight-bold">Решение:</p>
    <p class="mt-3 text-primary">Вы написали: {{enter}}</p>
    <p class="mt-3 text-success">Измененый вариант: {{task}}</p>

    <form method="post" action="">
    {% csrf_token %}
  <div class="form-group">
      {{form}}
<!--    <label for="exampleInputCity">Введите город</label>-->
<!--    <input type="text" class="form-control" id="exampleInputCity" aria-describedby="emailHelp">-->
    <small id="emailHelp" class="form-text text-muted">Если открыл фигурную скобку, не забудь закрыть ее!</small>
  </div>
  <button type="submit" class="btn btn-primary mb-3">Отправить</button>
</form>

    <button class="btn btn-outline-primary" onclick="document.getElementById('kod').hidden = document.getElementById('kod').hidden !== true;">Показать код</button>
    <a href="/tasks" class="btn btn-outline-primary">Вернуться</a>
    <div id="kod" style="background: lightgrey; width: 800px; padding-left: 10px; border-radius: 10px" class="mt-3" hidden="true">
<pre>
def check_re(af):
    h = re.findall(r'{(.*?)}', af)
    h1 = re.findall(r'{.*?}', af)
    try:
        if re.findall(r'({.*?{)', h1[0]):
            p = re.findall(r'{(.*?{.*?}.*?)}', af)
            p1 = re.findall(r'{.*?{.*?}.*?}', af)
            k = re.findall(r'{(.*?)}', p[0])

            if not re.findall(r'}.(.*)', p[0]):
                r = re.findall(r'}()', p[0])[0]
            else:
                r = re.findall(r'}(.*)', p[0])[0]
            msg = f"{re.findall(r'(.*?).{', p[0])[0]} {random.choice(k[0].split('|'))}{r}"
            return [random.choice(msg.split('|')), p1[0]]

        return [random.choice(h[0].split('|')), re.findall(r'{.*?}', af)[0]]
    except: return 0

while True:
    g = check_re(r)
    if not g:
        break
    elif g[1] != "":
        r = r.replace(g[1], g[0])
    else:
        break
</pre>
    </div>
</main>
{% endblock content %}
